{% extends "setup.html" %}

{% block title %}Add tariff to {{provider.name}}{% endblock %}

{% block content %}

<div class="row-fluid well well-small">
    <div class="span10">
        <h4>Add base tariff to provider {{provider.name}}</h4>
    </div>
    <div class="span2">
        <a href="{% url 'tarifica:setup' %}" class="btn btn-primary">
            Return to setup
        </a>
    </div>
</div>

<div class="row-fluid">
    <div class="span7 well well-small">
        <form action="{% url 'tarifica:destinations_create' provider.id %}" method="post" class="form-horizontal">{% csrf_token %}
            {{ form.non_field_errors }}
            <div class="control-group">
                {{ form.destination_name.errors }}
                <label class="control-label" for="id_destination_group">Destination</label>
                <div class="controls">
                    {{ form.destination_name }}
                    <span class="help-inline">Destination group for this tariff.</span>
                </div>
            </div>
            <div class="control-group">
                {{ form.destination_country.errors }}
                <label class="control-label" for="id_destination_group">Country</label>
                <div class="controls">
                    {{ form.destination_country }}
                    <span class="help-inline">Select a country for us to know where this tariff applies to.</span>
                </div>
            </div>
            <div class="control-group">
                {{ form.prefix.errors }}
                <label class="control-label" for="id_prefix">Call Prefix</label>
                <div class="controls">
                    {{ form.prefix }}
                    <span class="help-inline">The part of the dialed number which indicates where you're calling. It begins with a country code and (in most places) continues with an area code. It also changes according to your provider. If you're unsure of how you're calling, you can check it by accessing your Elastix call history.</span>
                </div>
            </div>
            <div class="control-group">
                {{ form.minute_fee.errors }}
                <label class="control-label" for="id_minute_fee">Minute Fee</label>
                <div class="controls">
                    <div class="input-prepend input-append">
                        <span class="add-on">{{ user_info.currency_symbol }}</span>
                        {{ form.minute_fee }}
                        <span class="add-on">{{ user_info.currency_code }}</span>
                    </div>
                    <span class="help-inline">If your provider bills you all calls to this prefix by minute, input the fee here.</span>
                </div>
            </div>
            <div class="control-group">
                {{ form.billing_interval.errors }}
                <label class="control-label" for="id_billing_interval">Billing interval</label>
                <div class="controls">
                    <div class="input-append">
                        {{ form.billing_interval }}
                        <span class="add-on">seconds</span>
                    </div>
                    <span class="help-inline">Billing intervals in seconds. If your provider bills you by minute, input '60' here. If your provider bills you by second, input '1'. If your provider bills you by 'x' seconds at a time, input 'x'.</span>
                </div>
            </div>
            <div class="control-group">
                {{ form.connection_fee.errors }}
                <label class="control-label" for="id_connection_fee">Connection Fee</label>
                <div class="controls">
                    <div class="input-prepend input-append">
                        <span class="add-on">{{ user_info.currency_symbol }}</span>
                        {{ form.connection_fee }}
                        <span class="add-on">{{ user_info.currency_code }}</span>
                    </div>
                    <span class="help-inline">If your provider bills you all calls to this prefix by the number of calls, not minutes, or if they bill you a call connection fee plus a minute fee, input the fee per call here.</span>
                </div>
            </div>
            <div class="control-group">
                {{ form.notes.errors }}
                <label class="control-label" for="id_notes">Notes</label>
                <div class="controls">
                    {{ form.notes }}
                    <span class="help-inline">Add custom notes to this base tariff.</span>
                </div>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Save Tariff</button>
                <a class="btn" href="{% url 'tarifica:setup' %}">Cancel</a>
            </div>
        </form>
    </div>

    <div class="span5 well well-small">
        <h4>Tariffs configured for provider {{ provider.name }}</h4>
        <hr>
        <table class="table table-striped table-condensed table-hovered">
            <thead>
                <tr>
                    <th>Destination</th>
                    <th>Prefix</th>
                    <th>Connection Fee</th>
                    <th>Minute Fee</th>
                </tr>
            </thead>
            <tbody>
                {% for dest in destinations %}
                <tr>
                    <td>
                        <img src="{{ dest.destination_country.flag }}">
                        {{ dest.destination_name.name }}
                    </td>
                    <td>
                        {% if dest.prefix = "" %}
                            Default
                        {% else %}
                            {{ dest.prefix }}
                        {% endif %}
                    </td>
                    <td>{{ user_info.currency_symbol }}{{ dest.connection_fee }} {{ user_info.currency_code }}</td>
                    <td>{{ user_info.currency_symbol }}{{ dest.minute_fee }} {{ user_info.currency_code }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>


{% endblock %}